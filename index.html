<!DOCTYPE html>

<html lang="pt-br">

<head>

    <meta charset="UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Inclui o arquivo de estilo CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- Define o ícone da página -->
    <link rel="icon" href="img/file.jpg">

    <!-- Inclui o arquivo de script JavaScript -->
    <script src="script.js"></script>

    <!--Links do bootstrap-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!--Links do biblioteca QRCode.js-->
    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    
    <!--Nome da pagina-->
    <title>Gerador de Texto com planilhas</title>

</head>

<body>

    <!-- Cabeçalho da página -->
    <header>

        <nav>

            <img src="img/file.jpg">

            <div>
                <h1>Gerador de texto</h1>
                <h3>Crie seu texto com sua planilha</h3>
            </div>

        </nav>

    </header>
    

    <div class="container" style="margin-top: 100px;">
        <h1>Substituir Dados do Excel</h1>
        <p>Cole os dados copiados do Excel (incluindo cabeçalhos) no campo abaixo:</p>
        <textarea id="input-data" placeholder="Cole aqui os dados copiados do Excel..."></textarea>
        <button id="generate">Gerar Texto</button>
    
        <div class="output" id="output-text"></div>

        <button id="copy-text" style="display: none;">Copiar Texto</button> <!-- Inicialmente escondido -->
      </div>
  
      <script>
        document.getElementById('generate').addEventListener('click', () => {
            const inputData = document.getElementById('input-data').value;
    
            // Dividir os dados por linhas
            const rows = inputData.split('\n').map(row => row.split('\t'));
    
            // Extrair cabeçalhos e valores
            const headers = rows[0]; // Primeira linha como cabeçalhos
            const values = rows[1]; // Segunda linha como valores
    
            // Criar objeto com os dados extraídos
            const data = {};
            headers.forEach((header, index) => {
                data[header.trim().toLowerCase()] = values[index]?.trim() || '---';
            });
    
            // Função para converter o número do mês no nome do mês
            const getMonthName = (date) => {
                const monthNames = [
                    'janeiro', 'fevereiro', 'março', 'abril', 'maio', 'junho',
                    'julho', 'agosto', 'setembro', 'outubro', 'novembro', 'dezembro'
                ];
                const parts = date.split('/'); // Supondo formato DD/MM/YYYY
                const monthIndex = parseInt(parts[1], 10) - 1; // Extrair o mês
                return monthNames[monthIndex] || 'mês inválido';
            };
    
            // Substituir valores undefined
            const empresa = (data['empresa'] || data['tomador']).toUpperCase(); // Empresa em maiúsculas
            const mesVigencia = data['vigência'] ? getMonthName(data['vigência']).toUpperCase() : 'MÊS NÃO INFORMADO'; // Mês em maiúsculas
    
            // Gerar o texto dinâmico
            const template = `
                <p><b>Assunto:</b> ${empresa} / RENOVAÇÃO JUDICIAL / Apólice: ${data['apólice']} / IS: ${data['is']} / Prazo: ${data['prazo']}</p>
                <p><b>Prezado Executivo(a),</b></p>
                <p>Em atenção às normas gerais aplicáveis ao Seguro Garantia Judicial, bem como considerando que a vigência da apólice emitida para a empresa <b>${empresa}</b> finda em <b>${mesVigencia}</b>, precisamos dar sequência aos procedimentos de renovação da respectiva garantia.</p>
                <p>Pedimos que nos informe se estamos em concorrência, para não corrermos o risco de perdermos o negócio por falta de estratégia e/ou taxa não competitiva.</p>
                <p><b>APÓLICE:</b> ${data['apólice']}</p>
                <p><b>TOMADOR:</b> ${data['tomador']}</p>
                <p><b>SEGURADORA:</b> ${data['seguradora']}</p>
                <p><b>IS:</b> ${data['is']}</p>
                <p><b>Vigência:</b> ${data['vigência']}</p>
                <p><b>Prazo:</b> ${data['prazo']}</p>
    
                
            `;
    
            // Exibir o texto formatado
            document.getElementById('output-text').innerHTML = template;
    
            // Exibir o botão de copiar
            document.getElementById('copy-text').style.display = 'inline-block';
    
            // Garantir que a página permita a rolagem
            setTimeout(() => {
                window.scrollTo(0, document.body.scrollHeight); // Rolar para o final de forma suave
            }, 100);
        });
    
        // Função para copiar o texto para a área de transferência
        document.getElementById('copy-text').addEventListener('click', () => {
            const textToCopy = document.getElementById('output-text').innerText;
    
            // Criação temporária de um campo de input para copiar o texto
            const textarea = document.createElement('textarea');
            textarea.value = textToCopy;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
    
            alert('Texto copiado com sucesso!');
        });
    </script>
    
    
    
    <!-- Rodapé da página -->
    <footer>
        <p>&copy; Todos os direitos reservados</p>
        <p id="clique-footer" onclick="redirecionarParaPagina1()">Desenvolvido por Hugo Daniel</p>
    </footer>

</body>

</html>